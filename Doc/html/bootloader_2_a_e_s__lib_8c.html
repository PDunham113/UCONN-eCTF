<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UConn Mitre eCTF: bootloader/AES_lib.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UConn Mitre eCTF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_19022d96b586671b8660603192be213a.html">bootloader</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AES_lib.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="bootloader_2_a_e_s__lib_8h_source.html">AES_lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bootloader_2_a_e_s__lib_2aes_8h_source.html">AES_lib/aes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bootloader_2uart_8h_source.html">uart.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for AES_lib.c:</div>
<div class="dyncontent">
<div class="center"><img src="bootloader_2_a_e_s__lib_8c__incl.png" border="0" usemap="#bootloader_2_a_e_s__lib_8c" alt=""/></div>
<!-- MAP 0 -->
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a18b65ad7379cf801828c018e11fdf60c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a18b65ad7379cf801828c018e11fdf60c">strtEncCFB</a> (uint8_t *key, uint8_t *firstBlockPlaintext, uint8_t *IV, <a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *ctx, uint8_t *firstBlockCiphertext)</td></tr>
<tr class="memdesc:a18b65ad7379cf801828c018e11fdf60c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begins encryption using AES-256 in CFB Mode on a single block.  <a href="#a18b65ad7379cf801828c018e11fdf60c">More...</a><br /></td></tr>
<tr class="separator:a18b65ad7379cf801828c018e11fdf60c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4663284fc59deb3bb5352fc2830802e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a4663284fc59deb3bb5352fc2830802e3">contEncCFB</a> (<a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *ctx, uint8_t *nextBlockPlaintext, uint8_t *prevBlockCiphertext, uint8_t *nextBlockCiphertext)</td></tr>
<tr class="memdesc:a4663284fc59deb3bb5352fc2830802e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continues encryption using AES-256 in CFB Mode on a single block.  <a href="#a4663284fc59deb3bb5352fc2830802e3">More...</a><br /></td></tr>
<tr class="separator:a4663284fc59deb3bb5352fc2830802e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1293746a164a1cd5c51456d51d8b98e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a1293746a164a1cd5c51456d51d8b98e2">encCFB</a> (uint8_t *key, uint8_t *data, uint8_t *IV, uint16_t size)</td></tr>
<tr class="memdesc:a1293746a164a1cd5c51456d51d8b98e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts data in-place using AES-256 in CFB Mode.  <a href="#a1293746a164a1cd5c51456d51d8b98e2">More...</a><br /></td></tr>
<tr class="separator:a1293746a164a1cd5c51456d51d8b98e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70658f2663a0816e85202cd00c3e22be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a70658f2663a0816e85202cd00c3e22be">strtDecCFB</a> (uint8_t *key, uint8_t *firstBlockCiphertext, uint8_t *IV, <a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *ctx, uint8_t *firstBlockPlaintext)</td></tr>
<tr class="memdesc:a70658f2663a0816e85202cd00c3e22be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begins decryption using AES-256 in CFB Mode on a single block.  <a href="#a70658f2663a0816e85202cd00c3e22be">More...</a><br /></td></tr>
<tr class="separator:a70658f2663a0816e85202cd00c3e22be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d64b249eb58f9c0a913d29a8eb75c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a72d64b249eb58f9c0a913d29a8eb75c5">contDecCFB</a> (<a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *ctx, uint8_t *nextBlockCiphertext, uint8_t *prevBlockCiphertext, uint8_t *nextBlockPlaintext)</td></tr>
<tr class="memdesc:a72d64b249eb58f9c0a913d29a8eb75c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continues decryption using AES-256 in CFB Mode on a single block.  <a href="#a72d64b249eb58f9c0a913d29a8eb75c5">More...</a><br /></td></tr>
<tr class="separator:a72d64b249eb58f9c0a913d29a8eb75c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7292bfcb36cd7de9609e60877fe6547f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootloader_2_a_e_s__lib_8c.html#a7292bfcb36cd7de9609e60877fe6547f">decCFB</a> (uint8_t *key, uint8_t *data, uint8_t *IV, uint16_t size)</td></tr>
<tr class="memdesc:a7292bfcb36cd7de9609e60877fe6547f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts data in-place using AES-256 in CFB Mode.  <a href="#a7292bfcb36cd7de9609e60877fe6547f">More...</a><br /></td></tr>
<tr class="separator:a7292bfcb36cd7de9609e60877fe6547f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a72d64b249eb58f9c0a913d29a8eb75c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d64b249eb58f9c0a913d29a8eb75c5">&#9670;&nbsp;</a></span>contDecCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contDecCFB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nextBlockCiphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>prevBlockCiphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nextBlockPlaintext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continues decryption using AES-256 in CFB Mode on a single block. </p>
<p>This method uses a standard AES-256 encryption kernel to decrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. Unlike other block cipher modes, the decryption method can also use the AES-256 encryption kernel, saving code space. The data array byte count MUST be divisible by 16. This should have been accounted for in the encryption function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Pointer to AES-256 Keyschedule. </td></tr>
    <tr><td class="paramname">nextBlockCiphertext</td><td>Pointer to data holding ciphertext block to be decrypted. </td></tr>
    <tr><td class="paramname">prevBlockCiphertext</td><td>Pointer to data holding previous block of ciphertext </td></tr>
    <tr><td class="paramname">nextBlockPlaintext</td><td>Pointer to memory that will hold next block of plaintext </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4663284fc59deb3bb5352fc2830802e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4663284fc59deb3bb5352fc2830802e3">&#9670;&nbsp;</a></span>contEncCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contEncCFB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nextBlockPlaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>prevBlockCiphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nextBlockCiphertext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continues encryption using AES-256 in CFB Mode on a single block. </p>
<p>This method uses a standard AES-256 encryption kernel to encrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. In addition, the corresponding decryption method can also use the AES-256 encryption kernel, saving code space. The data array byte count MUST be divisible by 16. This can be achieved through padding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Pointer to AES-256 Keyschedule. </td></tr>
    <tr><td class="paramname">nextBlockPlaintext</td><td>Pointer to data holding plaintext block to be encrypted. </td></tr>
    <tr><td class="paramname">prevBlockCiphertext</td><td>Pointer to data holding previous block of ciphertext </td></tr>
    <tr><td class="paramname">nextBlockCiphertext</td><td>Pointer to memory that will hold next block of ciphertext </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7292bfcb36cd7de9609e60877fe6547f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7292bfcb36cd7de9609e60877fe6547f">&#9670;&nbsp;</a></span>decCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void decCFB </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts data in-place using AES-256 in CFB Mode. </p>
<p>This method uses a standard AES-256 encryption kernel to decrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. Unlike other block cipher modes, the decryption method can also use the AES-256 encryption kernel, saving code space. The code will be decrypted block by block and stored in the same memory space used for the ciphertext. This results in drastic memory savings. The data array byte count MUST be divisible by 16. This should have been accounted for in the encryption function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to 32-byte array containing the AES-256 key. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to data array. Begins as ciphertext, ends as plaintext. </td></tr>
    <tr><td class="paramname">IV</td><td>Pointer to a 16-byte random Initialization Vector </td></tr>
    <tr><td class="paramname">size</td><td>Size in bytes of data array. Must be divisible by 16. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1293746a164a1cd5c51456d51d8b98e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1293746a164a1cd5c51456d51d8b98e2">&#9670;&nbsp;</a></span>encCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void encCFB </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts data in-place using AES-256 in CFB Mode. </p>
<p>This method uses a standard AES-256 encryption kernel to encrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. In addition, the corresponding decryption method can also use the AES-256 encryption kernel, saving code space. The code will be encrypted block by block and stored in the same memory space used for the plaintext. This results in drastic memory savings. The data array byte count MUST be divisible by 16. This can be achieved through padding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to 32-byte array containing the AES-256 key. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to data array. Begins as plaintext, ends as ciphertext. </td></tr>
    <tr><td class="paramname">IV</td><td>Pointer to a 16-byte random Initialization Vector </td></tr>
    <tr><td class="paramname">size</td><td>Size in bytes of data array. Must be divisible by 16. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70658f2663a0816e85202cd00c3e22be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70658f2663a0816e85202cd00c3e22be">&#9670;&nbsp;</a></span>strtDecCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void strtDecCFB </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>firstBlockCiphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>firstBlockPlaintext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begins decryption using AES-256 in CFB Mode on a single block. </p>
<p>This method uses a standard AES-256 encryption kernel to decrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. Unlike other block cipher modes, the decryption method can also use the AES-256 encryption kernel, saving code space. The data array byte count MUST be divisible by 16. This should have been accounted for in the encryption function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to 32-byte AES-256 key. </td></tr>
    <tr><td class="paramname">firstBlockCiphertext</td><td>Pointer to data holding ciphertext block to be decrypted. </td></tr>
    <tr><td class="paramname">IV</td><td>Pointer to 16-byte Initialization Vector </td></tr>
    <tr><td class="paramname">ctx</td><td>Pointer to AES-256 Keyschedule. </td></tr>
    <tr><td class="paramname">firstBlockPlaintext</td><td>Pointer to memory that will hold block of plaintext </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a18b65ad7379cf801828c018e11fdf60c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b65ad7379cf801828c018e11fdf60c">&#9670;&nbsp;</a></span>strtEncCFB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void strtEncCFB </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>firstBlockPlaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structaes256__ctx__t.html">aes256_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>firstBlockCiphertext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begins encryption using AES-256 in CFB Mode on a single block. </p>
<p>This method uses a standard AES-256 encryption kernel to encrypt data in CFB Mode. This essentially turns the block cipher into a self-correcting stream cipher. In addition, the corresponding decryption method can also use the AES-256 encryption kernel, saving code space. The data array byte count MUST be divisible by 16. This can be achieved through padding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to 32-byte AES-256 key. </td></tr>
    <tr><td class="paramname">firstBlockPlaintext</td><td>Pointer to data holding plaintext block to be encrypted. </td></tr>
    <tr><td class="paramname">IV</td><td>Pointer to 16-byte Initialization Vector </td></tr>
    <tr><td class="paramname">ctx</td><td>Pointer to AES-256 Keyschedule. </td></tr>
    <tr><td class="paramname">firstBlockCiphertext</td><td>Pointer to memory that will hold block of ciphertext </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 2 2017 12:26:16 for UConn Mitre eCTF by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
